    <div id="chart1" style="width: 100%; height: 400px;">

    </div>


<script type="text/javascript">

    // var base = 'http://localhost:3000/api/emissions/';
    // var endpoint = '<%=emission.country%>';
    // var url = base + endpoint;
    var url = '/api/emissions/<%= emission.country %>';
    jQuery.getJSON(url).done(processResult)

    let chartOne = echarts.init(document.getElementById('chart1'));

    function processResult(data) {
      console.log(data);

      // convert year strings to numeric year
      const cleanedData = data.map(d => ({
          year: new Date(d.year).getFullYear(),  // converts "1987-04-23" â†’ 1987
          annualco2: Number(d.annualco2)
      }));

      const xData = cleanedData.map(d => d.year);
      const yData = cleanedData.map(d => d.annualco2);

      let optionChartOne = {
          tooltip: {
              trigger: 'axis',
              valueFormatter: (value) => value.toFixed(1) + ' million tonnes',
              axisPointer: { type: 'line', label: { backgroundColor: '#6a7985' } },
              textStyle: { fontWeight: 300, color: '#212121' }
          },
          xAxis: { type: 'category', data: xData },
          yAxis: { type: 'value' },
          series: [
              { type: 'line', smooth: true, data: yData }
          ]
      };

      chartOne.setOption(optionChartOne);

      window.addEventListener('resize', function() { chartOne.resize(); });
  }
    
    // ensure chart recalculates if page fully loads
    window.addEventListener('load', function() {
        chartOne.resize();
    });

  
</script>